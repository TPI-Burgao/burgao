<div class="menu-container">
  <app-header (cartToggle)="toggleCart()"></app-header>

  <div class="menu-title">
    <h1>Menu</h1>
  </div>

  <div class="menu-grid">
    @for (item of menuItems; track item.title) {
      <div 
        class="menu-card"
        (click)="onMenuItemClick(item)"
      >
        <div class="card-image">
          <img [src]="item.image" [alt]="item.title">
          @if (item.isNew) {
            <span class="new-badge">Novo</span>
          }
        </div>
        <h3 class="card-title">{{ item.title }}</h3>
      </div>
    }
  </div>

  @if (selectedCategory) {
    <div class="modal-overlay" (click)="closeProducts()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ selectedCategory.title }}</h2>
          <button class="close-btn" (click)="closeProducts()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <div class="products-grid">
          @for (product of selectedCategory.products; track product.id) {
            <div class="product-card">
              <div class="product-image">
                <img [src]="product.image" [alt]="product.name">
              </div>
              <div class="product-info">
                <h3 class="product-name">{{ product.name }}</h3>
                <p class="product-description">{{ product.description }}</p>
                <div class="product-footer">
                  <span class="product-price">R$ {{ product.price.toFixed(2) }}</span>
                  
                  @if (getProductQuantity(product.id) === 0) {
                    <button class="add-to-cart-btn" (click)="addToCart(product)">
                      Adicionar
                    </button>
                  } @else {
                    <div class="quantity-controls-product">
                      <button class="quantity-btn-product" (click)="decrementProduct(product)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                          <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                      </button>
                      <span class="quantity-product">{{ getProductQuantity(product.id) }}</span>
                      <button class="quantity-btn-product" (click)="incrementProduct(product)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                          <line x1="12" y1="5" x2="12" y2="19"></line>
                          <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                      </button>
                    </div>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  }

  <app-cart [isOpen]="isCartOpen" (close)="closeCart()"></app-cart>
</div>