<div class="menu-container">
  <app-header (cartToggle)="toggleCart()"></app-header>

  <div class="menu-title">
    <h1>Menu</h1>
  </div>

  <div class="menu-grid">
    @for (item of menuItems; track item.titulo) {
      <div class="menu-card" (click)="onMenuItemClick(item)">
        <div class="card-image">
          <img [src]="item.imagem" [alt]="item.titulo">
        </div>

        <h3 class="card-title">{{ item.titulo }}</h3>
      </div>
    }
  </div>

  @if (categoriaSelecionada) {

    <div class="modal-overlay" (click)="fecharProdutos()">
      <div class="modal-content" (click)="$event.stopPropagation()">

        <div class="modal-header">
          <h2>{{ categoriaSelecionada.titulo }}</h2>

          <button class="close-btn" (click)="fecharProdutos()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>

          @if (categoriaSelecionada.titulo !== 'Combo em promoção') {
            <div class="filter-container">

              <button
                class="filter-btn"
                [class.active]="filtroAtual === 'todos'"
                (click)="setFiltro('todos')"
              >
                Todos
              </button>

              <button
                class="filter-btn"
                [class.active]="filtroAtual === 'promo'"
                (click)="setFiltro('promo')"
              >
                Promoção
              </button>

            </div>
          }
        </div>

        @if (mostrarMensagemSemPromo) {
          <p class="no-promo-message">
            Não há itens em promoção nesta categoria
          </p>
        }

        <div class="products-grid">

          @for (product of produtosFiltrados; track product.id) {

            <div class="product-card">
              <div class="product-image">
                <img [src]="product.imagem" [alt]="product.nome">
              </div>

              <div class="product-info">
                <h3 class="product-name">{{ product.nome }}</h3>
                <p class="product-description">{{ product.descricao }}</p>

                <div class="product-footer">

                  @if (filtroAtual === 'promo' && product.isPromo) {
                    <div class="price-box">
                      <span class="old-price">R$ {{ product.precoAntigo!.toFixed(2) }}</span>
                      <span class="promo-price">R$ {{ product.preco.toFixed(2) }}</span>
                    </div>
                  } @else {
                    <span class="product-price">R$ {{ product.preco.toFixed(2) }}</span>
                  }

                  <div class="quantity-small">
                    <button class="btn-qty" (click)="decrementarProduto(product)">−</button>
                    <span>{{ getQtdProduto(product.id) }}</span>
                    <button class="btn-qty" (click)="incrementarProduto(product)">+</button>
                  </div>

                  <button class="add-to-cart-btn" (click)="adicionarAoCarrinho(product)">
                    Adicionar
                  </button>

                </div>
              </div>
            </div>

          }

        </div>

      </div>
    </div>

  }

  <app-cart [isOpen]="isCartOpen" (close)="fecharCarrinho()"></app-cart>
</div>